var todomvc=function(exports){"use strict";var getType={}.toString,isFunction=function(functionToCheck){return functionToCheck&&"[object Function]"===getType.call(functionToCheck)},isDef=function(x){return void 0!==x},isUndef=function(x){return!isDef(x)},extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};var __assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},pathCallbacks=new WeakMap,isObject=function(obj){return null!==obj&&"object"==typeof obj&&"[object Object]"===Object.prototype.toString.call(obj)},deepValue=function(obj,path){if(!path)return obj;var i,n,paths=path.split("."),current=obj;for(i=0,n=paths.length;i<n;++i){if(void 0===current[paths[i]])return;current=current[paths[i]]}return current},merge=function(a,b){void 0===a&&(a={});for(var _i=0,_a=Object.keys(b);_i<_a.length;_i++){var k=_a[_i],ak=a[k],bk=b[k];Array.isArray(ak)?ak.push.apply(ak,bk):isObject(ak)?merge(ak,bk):a[k]=bk}return a},ensure=function(map,obj,defaultValue){var lookup=map.get(obj);return lookup?Array.isArray(lookup)&&Array.isArray(defaultValue)?lookup.push.apply(lookup,defaultValue):isObject(lookup)&&merge(lookup,defaultValue):map.set(obj,lookup=defaultValue),lookup},propertyCallbacks=new WeakMap,addPropertyListener=function(obj,property,callback){var _a,val=obj[property],observed=propertyCallbacks.has(obj)&&propertyCallbacks.get(obj)[property];ensure(propertyCallbacks,obj,((_a={})[property]=[callback],_a)),observed||Object.defineProperty(obj,property,{get:function(){return val},set:function(newVal){val=newVal;for(var _i=0,_a=propertyCallbacks.get(obj)[property];_i<_a.length;_i++){(0,_a[_i])(property)}return val}})},createObjectPropertyListener=function(obj,pathStr,callback){var _a,path=pathStr.split("."),property=path.pop(),root=deepValue(obj,path.join("."));ensure(pathCallbacks,obj,((_a={})[pathStr]=[callback],_a)),addPropertyListener(root,property,function(){for(var _i=0,_a=pathCallbacks.get(obj)[pathStr];_i<_a.length;_i++)(0,_a[_i])()})};function allChildNodes(node){for(var currentNode,walker=document.createTreeWalker(node,NodeFilter.SHOW_ALL,null,!1),nodes=[];((currentNode=walker.currentNode).nodeType!==Node.TEXT_NODE||currentNode.textContent.trim())&&nodes.push(currentNode),walker.nextNode(););return nodes}var cleanUpQueue=new WeakMap,registerCleanUp=function(node,task){return ensure(cleanUpQueue,node,[task])},cleanUp=function(node){return setTimeout(function(){for(var _i=0,_a=allChildNodes(node);_i<_a.length;_i++){var n=_a[_i];if(cleanUpQueue.has(n)){for(var _b=0,_c=cleanUpQueue.get(n);_b<_c.length;_b++){(0,_c[_b])()}cleanUpQueue.delete(n)}}},80)};var ConstructRegistry={},Singletons={},Construct=function(conf){return function(proto){ConstructRegistry[conf.selector]=proto,addToConstructorQueue(proto,function(widget,node){if(!0===conf.singleton){var name_1=(str=widget.constructor.name).charAt(0).toLowerCase()+str.substr(1);Singletons[name_1]=widget,registerCleanUp(node,function(){delete Singletons[name_1]})}var str;widget.init(node)})}},queue=new WeakMap,addToConstructorQueue=function(constructor,func){ensure(queue,constructor,[func])},afterRenderQueue=[],runAfterDomMount=function(root){afterRenderQueue.forEach(function(cb){root.contains(cb.node)&&cb.function()})},runConstructorQueue=function(widget,node){for(var widgetQueue=queue.get(Object.getPrototypeOf(widget).constructor)||[],i=0,n=widgetQueue.length;i<n;i++)widgetQueue[i].call(widget,widget,node)},observers=new WeakMap;function removeFromArray(arr,elements){if(arr&&0!==arr.length){for(var deleteCount=0,total=elements.length,i=arr.length;i--;)if(~elements.indexOf(arr[i]))deleteCount++;else if(deleteCount){if(arr.splice(i+1,deleteCount),0==(total-=deleteCount)){deleteCount=0;break}deleteCount=0}return deleteCount&&arr.splice(0,deleteCount),arr}}var notify=function(arr,method,args){for(var _i=0,listeners_1=observers.get(arr);_i<listeners_1.length;_i++){listeners_1[_i][method].apply(arr,args)}};var range=function(start$$1,end){for(var arr=new Array(end-start$$1+1),i=0,l=arr.length;i<l;i++)arr[i]=i+start$$1;return arr},observeArray=function(arr,listener){var listeners=observers.get(arr);listeners?listeners.push(listener):(observers.set(arr,[listener]),arr.pop=function(){return arr.splice(arr.length-1,1)[0]},arr.push=function(){for(var items=[],_i=0;_i<arguments.length;_i++)items[_i]=arguments[_i];return arr.splice.apply(arr,[arr.length,0].concat(items)),arr.length},arr.fill=function(){throw Error("observed arrays cannot be filled. items must be unique, use Array.splice instead!")},arr.reverse=function(){var ref=arr.slice();return arr.sort(function(a,b){return ref.indexOf(b)-ref.indexOf(a)}),arr},arr.shift=function(){return arr.splice(0,1)[0]},arr.unshift=function(){for(var items=[],_i=0;_i<arguments.length;_i++)items[_i]=arguments[_i];return arr.splice.apply(arr,[0,0].concat(items)),arr.length},function(arr){var old=arr.splice;arr.splice=function(index,deleteCount){var addedItems=[].slice.call(arguments,2),deletedItems=old.apply(arr,arguments);return notify(arr,"splice",[index,deleteCount,addedItems,deletedItems]),deletedItems}}(arr),function(arr){var old=arr.sort;arr.sort=function(cmp){var indices=range(0,arr.length-1),args=cmp?[arr.map(function(e,i){return i}).sort(function(a,b){return cmp(arr[a],arr[b])}).map(function(e){return indices[e]})]:indices,res=old.call(arr,cmp);return notify(arr,"sort",args),res}}(arr))};var Scope,computedProps=new WeakMap;function preventDefault(conf,ev){!0===conf.preventDefault&&ev.preventDefault()}!function(Scope){Scope[Scope.Direct=0]="Direct",Scope[Scope.Delegate=1]="Delegate",Scope[Scope.UntilMatch=2]="UntilMatch"}(Scope||(Scope={}));var TemplateTokenType,attachEvents=function(conf){return function(widget,node){(Array.isArray(conf.event)?conf.event:[conf.event]).forEach(function(event){conf.scope===Scope.Direct&&isDef(conf.selector)&&(node=node.querySelector(conf.selector));var handler=function(event,conf,widget,node,direct){return function(ev){if(direct)preventDefault(conf,ev),widget[conf.method].call(widget,ev,node);else{var el=ev.target;do{if(el.nodeType===Node.ELEMENT_NODE&&el.matches(conf.selector))return preventDefault(conf,ev),widget[conf.method].call(widget,ev,el);if(el===node&&conf.scope!==Scope.UntilMatch)break}while(el=el.parentElement)}}}(0,conf,widget,node,conf.scope===Scope.Direct||isUndef(conf.selector));node.addEventListener(event,handler,conf.options),registerCleanUp(node,function(){return node.removeEventListener(event,handler)})})}},On=function(conf){return function(proto,method){var finalConf=__assign({},conf,{method:method,event:conf.event||method,scope:Scope.Delegate});addToConstructorQueue(proto.constructor,attachEvents(finalConf))}},storableProperties=(function(_super){function ResponseError(message,response){var _this=_super.call(this,message)||this;return _this.response=response,_this}(function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)})(ResponseError,_super)}(Error),new WeakMap),store=function(key,value){window.localStorage.setItem(key,JSON.stringify({value:value}))},load=function(key){var json=window.localStorage.getItem(key);if(json)return JSON.parse(json).value},storeQueue=new WeakMap,storeArray=function(key,arr,proto){storeQueue.has(arr)&&clearTimeout(storeQueue.get(arr)),storeQueue.set(arr,setTimeout(function(){var props=storableProperties.get(proto);if(isUndef(props))throw Error("@LocalStorage array items must have at least one @Storable() property");var value=arr.map(function(i){return obj=i,props.reduce(function(a,c){return __assign({},a,((_a={})[c]=obj[c],_a));var _a},{});var obj});store(key,value)},80))},handler=function(prop,arrayType){return function(widget){var arr,callback,listener,storeKey=function(widget){var id=widget.id||widget.name||widget.title||widget.constructor.name;return isFunction(id)?id():id}(widget)+"."+prop,value=widget[prop];if(Array.isArray(value)){var type_1=isDef(arrayType)?arrayType():void 0;if(isUndef(type_1))throw Error("Stored array '"+prop+"' needs an arrayType factory argument");try{var tryValue=function(key,proto){var props=storableProperties.get(proto),arr=load(key);if(arr&&!isUndef(props))return arr.map(function(i){return props.reduce(function(p,c){return p[c]=i[c],p},new(Function.prototype.bind.apply(proto)))})}(storeKey,type_1);isDef(tryValue)&&(value=widget[prop]=tryValue)}catch(e){console.warn("LocalStorage loading failed...ignoring")}observeArray(arr=value,listener={sort:callback=function(){storeArray(storeKey,value,type_1)},splice:function(i,d,a){a.length&&a.forEach(function(item){var proto=Object.getPrototypeOf(item);storableProperties.get(proto.constructor).forEach(function(prop){addPropertyListener(item,prop,callback)})}),(a.length||0<d)&&callback()}}),listener.splice(0,0,arr)}else{tryValue=load(storeKey);isDef(tryValue)&&(widget[prop]=tryValue),addPropertyListener(widget,prop,function(){store(storeKey,widget[prop])})}}},Storable=function(){return function(proto,property){ensure(storableProperties,proto.constructor,[property])}},routeListeners={},namedRx=/[:*]\w+/gi,historyAPI=window.history&&window.history.pushState&&null===document.querySelector('[routing="hash"]'),rules=[[/:\w+/gi,"([\\w\\d-]+)"],[/\*\w+/gi,"(.+)"]],getCurrentRoute=function(){var path=location.pathname;return historyAPI||("/"!==path?location.replace("/#"+path):path=location.hash?location.hash.replace(/^#/,""):"/"),path},notifyListeners=function(route){Object.values(routeListeners).forEach(function(handlers){return handlers.forEach(function(rh){var matchedParams=function(pattern,input){var names=pattern.match(namedRx);if(names&&names.length){names=names.map(function(str){return str.substr(1)});var repl=rules.reduce(function(p,c){return p.replace(c[0],c[1])},pattern);return function(text,regex,matchNames){var matches=regex.exec(text);if(matches)return matches.reduce(function(result,match,index){return 0<index&&(result[matchNames[index-1]]=match),result},{})}(input,new RegExp("^"+repl+"$","gi"),names)}if(new RegExp("^"+pattern+"$","gi").exec(input))return{}}(rh.route,route);matchedParams&&rh.callback(matchedParams)})})},Route=function(route){return function(proto,method){addToConstructorQueue(proto.constructor,function(widget,node){routeListeners[route]||(routeListeners[route]=[]);var handler={route:route,callback:widget[method].bind(widget)};routeListeners[route].push(handler),registerCleanUp(node,function(){return routeListeners[route].splice(routeListeners[route].indexOf(handler),1)})})}},parsedTemplates=new WeakMap,SINGLE_CURLIES=/{(.*?)}/,CURLIES=/{{(.*?)}}/,ALL_CURLIES=/{{(.+?)}}/g,selfClosingTags=/(<([^<>\s]+)(\s+[^<>\s'"=]+(=[\w\d]+|="[^"]*"|='[^']*'|={{?[^}]*?}?})?)*)\s*\/>/gim;!function(TemplateTokenType){TemplateTokenType[TemplateTokenType.CLASS=0]="CLASS",TemplateTokenType[TemplateTokenType.PROPERTY=1]="PROPERTY",TemplateTokenType[TemplateTokenType.ATTRIBUTE=2]="ATTRIBUTE",TemplateTokenType[TemplateTokenType.TEMPLATE=3]="TEMPLATE",TemplateTokenType[TemplateTokenType.TEXT=4]="TEXT",TemplateTokenType[TemplateTokenType.TAG=5]="TAG"}(TemplateTokenType||(TemplateTokenType={}));var TemplateTokenInfo=function(){function TemplateTokenInfo(position,type){this.position=position,this.type=type}return TemplateTokenInfo.prototype.setCurly=function(value){var tokens=(this._curly=value).split(":");this._path=tokens.shift(),this._transformers=tokens},TemplateTokenInfo.prototype.curly=function(){return this._curly},TemplateTokenInfo.prototype.path=function(){return this._path},TemplateTokenInfo.prototype.transformers=function(){return this._transformers},TemplateTokenInfo.prototype.arrayTransformer=function(){if(1<this._transformers.length)throw Error("Array filter transformer can have only one method");return this.transformers()[0]},TemplateTokenInfo}(),breakApartTextNodes=function(root){for(var textNodes=function(node){for(var n,a=[],walk=document.createTreeWalker(node,NodeFilter.SHOW_TEXT,null,!1);n=walk.nextNode();)a.push(n);return a}(root),i=0,n=textNodes.length;i<n;i++){var node=textNodes[i],split=node.textContent.split(/({{.*?}})/gm);if(1<split.length){for(var parent_1=node.parentNode,frag=document.createDocumentFragment(),_i=0,split_1=split;_i<split_1.length;_i++){var text=split_1[_i];""!==text&&frag.appendChild(document.createTextNode(text))}parent_1.replaceChild(frag,node)}}return root},templateTag=document.createElement("template"),ParsedTemplate=function(){function ParsedTemplate(doc,nodes,infos){this.doc=doc,this.infos=infos,this.nodes=nodes}return ParsedTemplate.prototype.clone=function(){var doc=this.doc.cloneNode(!0);return new ParsedTemplate(doc,allChildNodes(doc),this.infos)},ParsedTemplate}(),getTemplate=function(widget,name){void 0===name&&(name="__default__");var proto=Object.getPrototypeOf(widget),templates=parsedTemplates.get(proto);if(isUndef(templates)||isUndef(templates[name]))throw Error("No template found for name "+name+" in "+widget.constructor.name);return templates[name].clone()},parseTemplate=function(templateStr){for(var html,m,source=templateStr.replace(selfClosingTags,"$1></$2>"),frag=breakApartTextNodes((html=source,templateTag.innerHTML=html,document.importNode(templateTag.content,!0))),allNodes=allChildNodes(frag),hookMap={};m=ALL_CURLIES.exec(templateStr);)hookMap[m[1].toLowerCase()]=m[1];return new ParsedTemplate(frag,allNodes,parseHooks(allNodes,hookMap))},parseHooks=function(nodes,hookMap){void 0===hookMap&&(hookMap={});for(var match,hooks=[],selectors=Object.keys(ConstructRegistry),_loop_1=function(pos,n){var node=nodes[pos];if(node.nodeType===Node.TEXT_NODE){var text=node.textContent,match_1=CURLIES.exec(text);if(null!==match_1)(token=new TemplateTokenInfo(pos,TemplateTokenType.TEXT)).setCurly(match_1[1]),hooks.push(token)}else if(node.nodeType===Node.ELEMENT_NODE){var matchingSelectors=selectors.filter(function(s){return node.matches(s)}),inSubWidget=matchingSelectors.length;if(inSubWidget)for(var _i=0,matchingSelectors_1=matchingSelectors;_i<matchingSelectors_1.length;_i++){var selector=matchingSelectors_1[_i];(token=new TemplateTokenInfo(pos,TemplateTokenType.TAG)).selector=selector,hooks.push(token)}for(var _a=0,_b=Array.from(node.attributes);_a<_b.length;_a++){var attribute=_b[_a],attributeName=attribute.nodeName;if("class"===attributeName)for(var _c=0,classes_1=Array.from(node.classList);_c<classes_1.length;_c++){var cls=classes_1[_c];if(match=cls.match(CURLIES))node.classList.remove(match[0]),(token=new TemplateTokenInfo(pos,TemplateTokenType.CLASS)).setCurly(match[1]),hooks.push(token)}else if(match=attributeName.match(CURLIES)){node.removeAttribute(match[0]),(token=new TemplateTokenInfo(pos,TemplateTokenType.PROPERTY)).setCurly(hookMap[match[1]]),hooks.push(token)}else if(!inSubWidget)if("template"===attributeName){(token=new TemplateTokenInfo(pos,TemplateTokenType.TEMPLATE)).attribute=attributeName,(match=attribute.value.match(CURLIES))?token.setCurly(match[1]):token.setCurly(attribute.value),hooks.push(token)}else{var token,value=attribute.value;if(match=value.match(CURLIES))node.removeAttribute(attributeName),(token=new TemplateTokenInfo(pos,TemplateTokenType.ATTRIBUTE)).setCurly(match[1]),token.attribute=attributeName,hooks.push(token)}}}},pos=0,n=nodes.length;pos<n;pos++)_loop_1(pos);return hooks},Template=function(name){return void 0===name&&(name="__default__"),function(proto,method){var _a,templateStr=proto[method].call(proto),template=parseTemplate(templateStr);ensure(parsedTemplates,proto,((_a={})[name]=template,_a))}},TransformerRegistry={},Inject=function(){return function(proto,property){addToConstructorQueue(proto.constructor,function(widget){var singleton=Singletons[property];isDef(singleton)&&(widget[property]=singleton)})}},TemplateNode=function(selector){return function(proto,property){var constructor,func;constructor=proto.constructor,func=function(widget,node){isUndef(widget[property])&&(widget[property]=node.querySelector(selector))},addToConstructorQueue(constructor,function(widget,node){var callback={node:node,function:function(){return func(widget,node)}};afterRenderQueue.push(callback),registerCleanUp(node,function(){return removeFromArray(afterRenderQueue,[callback])})})}},inArray=new WeakMap,subWidgets=new WeakMap,Update=function(){return new CustomEvent("__update__",{bubbles:!0,cancelable:!1,scoped:!1})},updateDomValue=function(node,info,value,oldValue){if(info.type===TemplateTokenType.TEXT)node.textContent=isDef(value)?value:"";else if(info.type===TemplateTokenType.CLASS)oldValue&&node.classList.remove((""+oldValue).replace(/\s+/g,"-")),value&&node.classList.add((""+value).replace(/\s+/g,"-"));else if(info.type===TemplateTokenType.ATTRIBUTE||info.type===TemplateTokenType.PROPERTY){var attributeName=info.attribute||info.path();if(/checked|value|selectedIndex/i.test(attributeName))node[attributeName]=value;else if(isUndef(value)||!1===value)node.removeAttribute(attributeName);else{var attrValue=!0===value?"":value;node.setAttribute(attributeName,attrValue)}}return value},updateDom=function(widget,template,transformMap,oldValueMap,noArray){void 0===noArray&&(noArray=!1);for(var domChanged=!1,valueMap=getCurrentValueMap(widget,template,transformMap),info=void 0,i=0,n=template.infos.length;i<n;i++)if((info=template.infos[i]).type!==TemplateTokenType.TAG){var value=valueMap[i];if(value!==ARRAY_TAG)if(value!==FILTERED_ARRAY_TAG){var oldValue=oldValueMap[i];oldValue!==value&&(domChanged=!0,oldValueMap[i]=updateDomValue(template.nodes[info.position],info,value,oldValue))}else noArray||widget[info.path()].splice(0,0)}return{change:domChanged,valueMap:oldValueMap}},ARRAY_TAG=Symbol("array_tag"),FILTERED_ARRAY_TAG=Symbol("filtered_array_tag"),getInfoValue=function(widget,info,transformMap){var path=info.path(),transformer=transformMap[info.curly()],v=deepValue(widget,path);return info.type===TemplateTokenType.PROPERTY&&Array.isArray(v)?isFunction(transformer(v))?FILTERED_ARRAY_TAG:ARRAY_TAG:(v=isFunction(v)?v.call(widget):v,v=transformer?transformer(v):v)},getCurrentValueMap=function(widget,template,transformMap){for(var map=[],i=0,n=template.infos.length;i<n;i++)map[i]=getInfoValue(widget,template.infos[i],transformMap);return map},bindArray=function(array,parentNode,widget,info,templateName,update){var transformer=info.arrayTransformer()?transformFactory(widget,info.transformers())():void 0;return function(arr,el,update,onItemAdded,filter){var nodeVisible=[],elementMap=new WeakMap,listener={sort:function(indices){for(var copy=[],i=0;i<indices.length;i++)nodeVisible[indices[i]]&&el.appendChild(elementMap.get(arr[i])),copy[i]=nodeVisible[indices[i]];nodeVisible=copy},splice:function(index,deleteCount,added,deleted){void 0===deleted&&(deleted=[]);var patch=Array.from(nodeVisible),patchHelper=[index,deleteCount].concat(added.map(function(){return!1}));if(nodeVisible.splice.apply(nodeVisible,patchHelper),deleteCount)for(var del=void 0,d=0;d<deleteCount;d++){del=deleted[d];var node=elementMap.get(del);node&&node.parentElement===el&&el.removeChild(node),isDef(node)&&cleanUp(node),elementMap.delete(del)}if(added.length)for(var item=void 0,a=0,n=added.length;a<n;a++)item=added[a],elementMap.set(item,onItemAdded(item));(deleteCount||added.length)&&update(!0),patch.splice.apply(patch,patchHelper);var i=0;for(n=arr.length;i<n;i++){patch[i]=isUndef(filter)||filter(arr[i],i);var itemNode=elementMap.get(arr[i]);if(patch[i]&&!nodeVisible[i]){var nextVisible=nodeVisible.indexOf(!0,i),refNode=~nextVisible?elementMap.get(arr[nextVisible]):void 0;el.insertBefore(itemNode,refNode),runAfterDomMount(el)}else!patch[i]&&nodeVisible[i]&&itemNode.parentNode===el&&el.removeChild(itemNode)}nodeVisible=patch}};return listener.splice(0,0,arr,[]),registerCleanUp(el,function(){observers.has(arr)&&removeFromArray(observers.get(arr),[listener])}),observeArray(arr,listener),listener}(array,parentNode,update,function(item){!function(widget,array){var proto=Object.getPrototypeOf(widget);inArray.has(proto)&&(widget[inArray.get(proto)]=array)}(item,array);var template=getTemplate(item,templateName()),node=template.nodes[1];return runConstructorQueue(item,node),connectTemplate(item,node,template,parentNode),node},transformer)},bindTemplateInfos=function(template,widget,updateTemplate,transformMap){for(var out_info_1,bound=[],infos=template.infos,_loop_2=function(info,i,n){var path=(info=infos[i]).path(),value=deepValue(widget,info.path()),node=template.nodes[info.position];if(info.type===TemplateTokenType.TAG)!function(widget,rootInfo,node){var subWidget=new(Function.prototype.bind.apply(ConstructRegistry[rootInfo.selector]));ensure(subWidgets,widget,[subWidget]);for(var out_attribute_1,attributes=Array.prototype.slice.call(node.attributes),_loop_1=function(attribute,i,n){var match=(attribute=attributes[i]).value.match(CURLIES),subProp=attribute.name.replace(/\b-([a-z])/g,function(all,char){return char.toUpperCase()});if(match){var prop_1=match[1],value=deepValue(widget,prop_1);if(isFunction(value))subWidget[subProp]=value.bind(widget);else{if(~prop_1.indexOf(":"))throw Error("Cannot use transformer for "+prop_1);var updateVal_1=function(){return subWidget[subProp]=deepValue(widget,prop_1),updateVal_1};addPropertyListener(widget,prop_1,updateVal_1())}node.removeAttribute(attribute.name)}else(match=attribute.value.match(SINGLE_CURLIES))?(subWidget[subProp]=new Function("return "+match[1])(),node.removeAttribute(attribute.name)):subWidget[subProp]=attribute.value;out_attribute_1=attribute},attribute=void 0,i=0,n=attributes.length;i<n;i++)_loop_1(attribute,i),attribute=out_attribute_1;runConstructorQueue(subWidget,node)}(widget,info,node);else if(info.type===TemplateTokenType.PROPERTY){if(Array.isArray(value)){var templateInfo_1=function(template,position){return template.infos.find(function(i){return i.position===position&&"template"===i.attribute})}(template,info.position),attributeValue_1=node.getAttribute("template")||void 0,templateName=void 0;isDef(templateInfo_1)&&CURLIES.test(attributeValue_1)?(templateName=function(){return getInfoValue(widget,templateInfo_1,transformMap)},addPropertyListener(widget,templateInfo_1.path(),function(){value.splice.apply(value,[0,value.length].concat(value))})):templateName=function(){return attributeValue_1},bindArray(value,node,widget,info,templateName,updateTemplate),node.removeAttribute("template")}}else if(isFunction(value))!function(widget,info,updateDom){var proto=Object.getPrototypeOf(widget);if(!computedProps.has(proto)||!computedProps.get(proto)[info.path()])throw Error("Bound functions must be decorated with @Computed(...paths: string[])");computedProps.get(proto)[info.path()].forEach(function(prop){return createObjectPropertyListener(widget,prop,function(){return updateDom()})})}(widget,info,updateTemplate);else if(info.type===TemplateTokenType.TEMPLATE){var propInfo=function(template,position){return template.infos.find(function(i){return i.position===position&&i.type===TemplateTokenType.PROPERTY})}(template,info.position);!isUndef(propInfo)&&Array.isArray(deepValue(widget,propInfo.path()))||function(widget,node,info,transformMap){var value=getInfoValue(widget,info,transformMap);if(isDef(value)){var updateTemplateNode_1=function(){var value=getInfoValue(widget,info,transformMap);return render(widget,node,value),updateTemplateNode_1};addPropertyListener(widget,info.path(),updateTemplateNode_1())}else render(widget,node,info.curly());node.removeAttribute("template")}(widget,node,info,transformMap)}else bound.includes(path)||Array.isArray(value)||(bound.push(path),createObjectPropertyListener(widget,path,function(){return updateTemplate()}));out_info_1=info},info=void 0,i=0,n=infos.length;i<n;i++)_loop_2(info,i),info=out_info_1},connectTemplate=function(widget,el,template,parentNode){void 0===parentNode&&(parentNode=el.parentNode);var transformMap=function(widget,template){for(var map={},info=void 0,i=0,n=template.infos.length;i<n;i++){var transformers=(info=template.infos[i]).transformers();transformers&&(map[info.curly()]=transformFactory(widget,transformers))}return map}(widget,template),res=updateDom(widget,template,transformMap,[]),updateTemplate=function(noArray){void 0===noArray&&(noArray=!1),mutedWidget.has(widget)||(res=updateDom(widget,template,transformMap,res.valueMap,noArray)).change&&parentNode.dispatchEvent(Update())};el.addEventListener("__update__",function(){return updateTemplate()},{passive:!0,capture:!1}),bindTemplateInfos(template,widget,updateTemplate,transformMap)},transformFactory=function(widget,transformers){return fns=transformers.map(function(m){var transformer=widget[m]||TransformerRegistry[m];if(isUndef(transformer))throw Error("No transformer found for "+m+". Implement function on "+widget.constructor.name+" or annotate a method with @Transformer()");return transformer.bind(widget)}),function(res){return 1===fns.length?fns[0](res):fns.reduce(function(p,c){return c(p)},res)};var fns},render=function(widget,el,name){for(var children=allChildNodes(el),node=void 0,i=1,n=children.length;i<n;i++)(node=children[i]).parentNode===el&&el.removeChild(node),cleanUp(node);var template=getTemplate(widget,name);connectTemplate(widget,el,template),el.appendChild(template.doc)},mutedWidget=new WeakMap;var ListState;!function(css,ref){void 0===ref&&(ref={});var insertAt=ref.insertAt;if(css&&"undefined"!=typeof document){var head=document.head||document.getElementsByTagName("head")[0],style=document.createElement("style");style.type="text/css","top"===insertAt&&head.firstChild?head.insertBefore(style,head.firstChild):head.appendChild(style),style.styleSheet?style.styleSheet.cssText=css:style.appendChild(document.createTextNode(css))}}("[hidden] {\n    display: none !important;\n}\n"),function(ListState){ListState[ListState.ALL=0]="ALL",ListState[ListState.COMPLETED=1]="COMPLETED",ListState[ListState.ACTIVE=2]="ACTIVE"}(ListState||(ListState={}));function __decorate$1(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;0<=i;i--)(d=decorators[i])&&(r=(c<3?d(r):3<c?d(target,key,r):d(target,key))||r);return 3<c&&r&&Object.defineProperty(target,key,r),r}var Click=function(selector){return On({selector:selector,event:"click",preventDefault:!0})},Todo=(function(){function TodoList(){var _this=this;this.state=ListState.ALL,this.todos=[],this.init=function(el){render(_this,el)},this.listFilter=function(){return function(todo){return _this.state===ListState.ALL||_this.state===ListState.COMPLETED&&todo.completed||_this.state===ListState.ACTIVE&&!todo.completed}},this.stateAll=function(s){return _this.selectedState(s,ListState.ALL)},this.stateActive=function(s){return _this.selectedState(s,ListState.ACTIVE)},this.stateCompleted=function(s){return _this.selectedState(s,ListState.COMPLETED)},this.isEmpty=function(){return 0===_this.todos.length},this.noCompleted=function(){return 0===_this.completed()},this.pluralize=function(){return 1===_this.active()?"item":"items"},this.allCompleted=function(){return _this.completed()===_this.todos.length},this.active=function(){return _this.todos.length-_this.completed()},this.completed=function(){return _this.todos.filter(function(c){return c.completed}).length},this.selectedState=function(s,state){return s===state?"selected":void 0}}var arrayType;TodoList.prototype.newTodo=function(todo){this.todos.push(todo)},TodoList.prototype.deleteTodo=function(todo){removeFromArray(this.todos,[todo])},TodoList.prototype.locationPath=function(params){"active"===params.path?this.state=ListState.ACTIVE:"completed"===params.path&&(this.state=ListState.COMPLETED)},TodoList.prototype.root=function(){this.state=ListState.ALL},TodoList.prototype.clearCompleted=function(){removeFromArray(this.todos,this.todos.filter(function(t){return t.completed}))},TodoList.prototype.toggleAll=function(){var state=!this.allCompleted();this.todos.forEach(function(t){return t.completed=state})},TodoList.prototype.toHtml=function(){return'\n        <header class="header"/>\n        <section class="main">\n          <input class="toggle-all" type="checkbox" checked="{{todos:allCompleted}}">\n          <label for="toggle-all" hidden="{{todos:isEmpty}}">Mark all as complete</label>\n          <ul class="todo-list" {{todos:listFilter}}/>\n        </section>\n        <footer class="footer" hidden="{{todos:isEmpty}}">\n          <span class="todo-count"><strong>{{todos:active}}</strong> {{todos:pluralize}} left</span>\n          <ul class="filters">\n            <li><a class="{{state:stateAll}}" href="#/">All</a></li>\n            <li><a class="{{state:stateActive}}" href="#/active">Active</a></li>\n            <li><a class="{{state:stateCompleted}}" href="#/completed">Completed</a></li>\n          </ul>\n          <button class="clear-completed" hidden="{{todos:noCompleted}}">Clear completed</button>\n        </footer>'},__decorate$1([(arrayType=function(){return Todo},function(proto,property){addToConstructorQueue(proto.constructor,handler(property,arrayType))})],TodoList.prototype,"todos",void 0),__decorate$1([Route("/:path")],TodoList.prototype,"locationPath",null),__decorate$1([Route("/")],TodoList.prototype,"root",null),__decorate$1([Click(".clear-completed")],TodoList.prototype,"clearCompleted",null),__decorate$1([Click('label[for="toggle-all"]'),function(proto,method){addToConstructorQueue(proto.constructor,function(widget,el){var old=widget[method];Object.defineProperty(widget,method,{value:function(){mutedWidget.set(widget,!0),old.apply(widget,arguments),mutedWidget.delete(widget),el.dispatchEvent(Update())}})})}],TodoList.prototype,"toggleAll",null),__decorate$1([Template()],TodoList.prototype,"toHtml",null),TodoList=__decorate$1([Construct({selector:".todoapp",singleton:!0})],TodoList)}(),function(){function Todo(name,completed){void 0===completed&&(completed=!1),this.editing=!1,this.completedClass=function(completed){return completed?"completed":void 0},this.editingClass=function(editing){return editing?"editing":void 0},this.completed=completed,this.name=name}return Todo.prototype.complete=function(ev){this.completed=ev.target.checked},Todo.prototype.deleteSelf=function(){this.todoList.deleteTodo(this)},Todo.prototype.startEditing=function(){this.edit.value=this.name,this.editing=!0,this.edit.focus()},Todo.prototype.endEditing=function(ev){13===ev.keyCode&&(this.name=this.edit.value.trim(),this.name||this.todoList.deleteTodo(this),this.stopEditing())},Todo.prototype.cancelEditing=function(ev){27===ev.keyCode&&this.stopEditing()},Todo.prototype.stopEditing=function(){this.editing=!1},Todo.prototype.toHtml=function(){return'\n        <li class="{{completed:completedClass}} {{editing:editingClass}}">\n          <div class="view">\n            <input class="toggle" type="checkbox" checked="{{completed}}">\n            <label>{{name}}</label>\n            <button class="destroy"></button>\n          </div>\n          <input class="edit" placeholder="Create a TodoMVC template" value="{{name}}">\n        </li>'},__decorate$1([Storable()],Todo.prototype,"completed",void 0),__decorate$1([Storable()],Todo.prototype,"name",void 0),__decorate$1([Inject()],Todo.prototype,"todoList",void 0),__decorate$1([TemplateNode(".edit")],Todo.prototype,"edit",void 0),__decorate$1([On({event:"click",selector:".toggle"})],Todo.prototype,"complete",null),__decorate$1([Click(".destroy")],Todo.prototype,"deleteSelf",null),__decorate$1([On({event:"dblclick",selector:"label"})],Todo.prototype,"startEditing",null),__decorate$1([On({event:"keyup",selector:".edit"})],Todo.prototype,"endEditing",null),__decorate$1([On({event:"keyup",scope:Scope.Direct})],Todo.prototype,"cancelEditing",null),__decorate$1([On({event:["blur","focusout"],selector:"input.edit",scope:Scope.Direct})],Todo.prototype,"stopEditing",null),__decorate$1([Template()],Todo.prototype,"toHtml",null),Todo}());!function(){function Header(){}Header.prototype.init=function(element){render(this,element)},Header.prototype.createTodo=function(ev){var e=this.edit;13===ev.keyCode&&e.value.trim()&&(this.todoList.newTodo(new Todo(e.value)),e.value="")},Header.prototype.toHtml=function(){return'\n            <h1>todos</h1>\n            <input class="new-todo" id="new-todo" placeholder="What needs to be done?" autofocus>\n        '},__decorate$1([Inject()],Header.prototype,"todoList",void 0),__decorate$1([TemplateNode(".new-todo")],Header.prototype,"edit",void 0),__decorate$1([On({event:"keypress",selector:"input",scope:Scope.Direct})],Header.prototype,"createTodo",null),__decorate$1([Template()],Header.prototype,"toHtml",null),Header=__decorate$1([Construct({selector:".header"})],Header)}();return function(root){void 0===root&&(root=document.documentElement);var createdWidgets=[];Object.keys(ConstructRegistry).forEach(function(selector){Array.from(root.querySelectorAll(selector)).forEach(function(node){var widget=new(Function.prototype.bind.apply(ConstructRegistry[selector]));runConstructorQueue(widget,node),createdWidgets.push(widget),runAfterDomMount(node)})})}(),window.blockRouting||notifyListeners(getCurrentRoute()),window.addEventListener(historyAPI?"popstate":"hashchange",function(){return notifyListeners(getCurrentRoute())},!1),{}}();
//# sourceMappingURL=todomvc.min.js.map